<?xml version="1.0" encoding="ASCII"?>
<securitymodels:SecurityModel xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:datamodels="/final/metamodel/datamodels.ecore" xmlns:securitymodels="/final/metamodel/securitymodels.ecore" name="University">
  <rules name="readBasicInfo" protectedResources="//@resources.0 //@resources.1">
    <auths textual="Any one with a role can read any registered user basic information" oclExp="true" sqlStm="TRUE" roles="//@roles.0 //@roles.1 //@roles.2"/>
  </rules>
  <rules name="readStudentSpecificInfo" protectedResources="//@resources.3">
    <auths textual="Administrator can read any student intake year" oclExp="true" sqlStm="TRUE" roles="//@roles.0"/>
    <auths textual="Student can read its classmates' intake year" oclExp="caller.enrolled->exists(c|c.students->includes(self))" sqlStm="caller = self" roles="//@roles.2"/>
    <auths textual="Lecturer can read its students' intake year" oclExp="caller.taught->exists(c|c.students->includes(self))" sqlStm="" roles="//@roles.1"/>
  </rules>
  <rules name="readLecturerSpecificInfo" protectedResources="//@resources.2">
    <auths textual="Lecturer can read its own salary" oclExp="true" sqlStm="TRUE" roles="//@roles.1"/>
  </rules>
  <roles name="Administrator">
    <userEntity href="University.sm#|11"/>
  </roles>
  <roles name="Lecturer">
    <userEntity href="University.sm#|12"/>
  </roles>
  <roles name="Student">
    <userEntity href="University.sm#|13"/>
  </roles>
  <resources name="regUserEmail">
    <property xsi:type="datamodels:AssociationEnd" href="University.sm#|14"/>
  </resources>
  <resources name="regUserName">
    <property xsi:type="datamodels:AssociationEnd" href="University.sm#|15"/>
  </resources>
  <resources name="lecturerSalary">
    <property xsi:type="datamodels:AssociationEnd" href="University.sm#|16"/>
  </resources>
  <resources name="studentIntake">
    <property xsi:type="datamodels:AssociationEnd" href="University.sm#|17"/>
  </resources>
</securitymodels:SecurityModel>
